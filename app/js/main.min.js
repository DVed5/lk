let mediaCount=0,reportCount=0;const chatBody=document.getElementById("chat-body"),chatWelcome=document.querySelector(".dashboard-chat__body-welcome"),filesWelcome=document.querySelector(".dashboard-files__info"),filesWrapper=document.querySelector(".dashboard-files__wrapper"),mediaFiles=document.getElementById("media-files"),reportFiles=document.getElementById("report-files");function appendChatMessage(e,t){chatWelcome.classList.add("visually-hidden"),chatBody.classList.remove("visually-hidden");const d=(new Date).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),l=document.createElement("div");l.classList.add("dashboard-chat__message"),l.innerHTML=` ${t} <span class="dashboard-chat__message-time">${d}</span>`,chatBody.appendChild(l),chatBody.scrollTop=chatBody.scrollHeight}function simulateAsync(e){filesWelcome.classList.add("visually-hidden"),filesWrapper.classList.remove("visually-hidden");const t=`Companyname ${"media"===e?++mediaCount:++reportCount}/25`,d="media"===e?mediaFiles:reportFiles,l=document.createElement("div");l.classList.add("dashboard-files__media-document");const s=document.createElement("img");s.src="../images/file-icon.svg",s.alt="Файл";const n=document.createElement("span");n.textContent=t,n.classList.add("document-name");const i=document.createElement("img");i.src="../images/file-dwl.svg",i.alt="Файл",l.appendChild(s),l.appendChild(n),l.appendChild(i);const a=document.createElement("p");a.classList.add("dashboard-files__note"),a.innerHTML=`\n\t${"media"===e?"Медиаплан формируется...":"Отчет формируется..."}\n`,d.appendChild(l),d.appendChild(a),"media"===e?handleShowMore(mediaFiles,"show-more-media","media"):handleShowMore(reportFiles,"show-more-report","report"),appendChatMessage("PinkChicken",`Заказ ${"media"===e?"медиаплана":"отчета"} принят. Ожидайте.`),setTimeout((()=>{a.innerHTML=`${"media"===e?"Медиаплан":"Отчет"} от ${(new Date).toLocaleDateString("ru-RU")} готов</>`,appendChatMessage("PinkChicken",`${"media"===e?"Медиаплан":"Отчет"} "${t}" сформирован`),setTimeout((()=>{a.remove()}),2e3)}),2e3)}let mediaIndex=null,reportIndex=null;const limit=3;function handleShowMore(e,t,d){const l=[...e.querySelectorAll(".dashboard-files__media-document, .dashboard-files__report-document")],s=document.getElementById(t);if(l.length<=limit)return l.forEach((e=>e.style.display="flex")),void s.classList.add("visually-hidden");s.classList.remove("visually-hidden"),"media"===d?(mediaIndex=(l.length-limit+l.length)%l.length,showDocumentWindow(l,mediaIndex,limit)):(reportIndex=(l.length-limit+l.length)%l.length,showDocumentWindow(l,reportIndex,limit)),s.onclick=()=>{"media"===d?(mediaIndex=(mediaIndex-1+l.length)%l.length,showDocumentWindow(l,mediaIndex,limit)):(reportIndex=(reportIndex-1+l.length)%l.length,showDocumentWindow(l,reportIndex,limit))}}function showDocumentWindow(e,t,d){const l=e.length;e.forEach((e=>{e.style.display="none"}));for(let s=0;s<d;s++){e[(t+s)%l].style.display="flex"}}document.getElementById("order-media").addEventListener("click",(()=>simulateAsync("media"))),document.getElementById("order-report").addEventListener("click",(()=>simulateAsync("report"))),document.getElementById("send-message").addEventListener("click",(()=>{const e=document.getElementById("chat-message"),t=e.value.trim();t&&(appendChatMessage("Вы",t),e.value="")})),document.getElementById("chat-message").addEventListener("keydown",(e=>{"Enter"===e.key&&document.getElementById("send-message").click()})),document.getElementById("toggle-media").addEventListener("click",(()=>{const e=mediaFiles.querySelectorAll(".dashboard-files__media-document"),t=document.getElementById("show-more-media"),d=mediaFiles.querySelectorAll(".dashboard-files__note");e.forEach((e=>{e.classList.toggle("visually-hidden")})),t&&!t.classList.contains("visually-hidden")&&t.classList.toggle("visually-hidden"),d.forEach((e=>e.classList.toggle("visually-hidden"))),document.getElementById("toggle-media").classList.toggle("collapsed"),document.getElementById("toggle-media").classList.contains("collapsed")?t.classList.add("visually-hidden"):handleShowMore(mediaFiles,"show-more-media","media")})),document.getElementById("toggle-report").addEventListener("click",(()=>{const e=reportFiles.querySelectorAll(".dashboard-files__report-document"),t=document.getElementById("show-more-report"),d=reportFiles.querySelectorAll(".dashboard-files__note");e.forEach((e=>{e.classList.toggle("visually-hidden")})),t&&!t.classList.contains("visually-hidden")&&t.classList.toggle("visually-hidden"),d.forEach((e=>e.classList.toggle("visually-hidden"))),document.getElementById("toggle-report").classList.toggle("collapsed")}));