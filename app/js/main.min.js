const mobileQuery=window.matchMedia("(max-width: 535px)");function handleScreenSizeChange(e){const t=document.querySelector(".dashboard-files__mobile-only"),s=document.querySelector(".dashboard-files");e.matches?(t.classList.remove("visually-hidden"),s.classList.add("visually-hidden")):(t.classList.add("visually-hidden"),s.classList.remove("visually-hidden"))}handleScreenSizeChange(mobileQuery),mobileQuery.addEventListener("change",handleScreenSizeChange);let mediaCount=0,reportCount=0;const chatBody=document.getElementById("chat-body"),chatWelcome=document.querySelector(".dashboard-chat__body-welcome"),filesWelcome=document.querySelector(".dashboard-files__info"),filesWrapper=document.querySelector(".dashboard-files__wrapper"),mediaFiles=document.getElementById("media-files"),reportFiles=document.getElementById("report-files");function appendChatMessage(e,t,s,a){chatWelcome.classList.add("visually-hidden"),chatBody.classList.remove("visually-hidden");const d=(new Date).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),i=document.createElement("div");i.classList.add(s),i.innerHTML="Jim"===e?`\n\t\t\n\t\t\t\t<img class="dashboard-chat__avatar" width="49" height="49" src="../images/admin-photo.png" alt="">\n\t\t\t\t<div class="dashboard-chat__content">\n\t\t\t<span class="dashboard-chat__sender">${e}</span>${t} <span class="${a}">${d}</span>\n\t\t\t\t</div>\n\t\t\n\t\t\t`:`\n\t\t<span class="dashboard-chat__sender">${e}</span>${t} <span class="${a}">${d}</span>\n\t\t`,chatBody.appendChild(i),chatBody.scrollTop=chatBody.scrollHeight}function simulateAsync(e){filesWelcome.classList.add("visually-hidden"),filesWrapper.classList.remove("visually-hidden");const t=`Companyname ${"media"===e?++mediaCount:++reportCount}/25`,s="media"===e?mediaFiles:reportFiles,a=document.createElement("div");a.classList.add("dashboard-files__media-document");const d=document.createElement("img");d.src="../images/file-icon.svg",d.alt="Файл";const i=document.createElement("span");i.textContent=t,i.classList.add("document-name");const l=document.createElement("img");l.src="../images/file-dwl.svg",l.alt="Файл";const o=document.createElement("img");o.src="../images/file-process.svg",o.alt="Файл",a.appendChild(d),a.appendChild(i),a.appendChild(o);const n=document.createElement("p");n.classList.add("dashboard-files__note"),n.innerHTML='<img src="../images/status-icon.svg" alt="" style="display:inline; width:16px;height:16px;margin-right: 5px;vertical-align: middle;">'+("media"===e?"Медиаплан формируется...":"Отчет формируется..."),s.appendChild(a),s.appendChild(n),"media"===e?ShowMore(mediaFiles,"show-more-media","media"):ShowMore(reportFiles,"show-more-report","report"),appendChatMessage("Jim",`Заказ ${"media"===e?"медиаплана":"отчета"} принят. Ожидайте.`,"dashboard-chat__status","dashboard-chat__status-time"),setTimeout((()=>{n.classList.add("dashboard-files__note"),n.innerHTML=`<img src="../images/ready-icon.svg" alt="" style="display:inline; width:16px;height:16px;margin-right: 5px;vertical-align: middle;">${"media"===e?"Медиаплан":"Отчет"} от ${(new Date).toLocaleDateString("ru-RU")} готов`,appendChatMessage("Jim",`${"media"===e?"Медиаплан":"Отчет"} "${t}" сформирован`,"dashboard-chat__status","dashboard-chat__status-time"),a.replaceChild(l,o),checkFilesReady(),setTimeout((()=>{n.remove()}),2e3)}),2e3)}let mediaIndex=null,reportIndex=null;const limit=3;function ShowMore(e,t,s){const a=[...e.querySelectorAll(".dashboard-files__media-document")],d=document.getElementById(t);if(a.length<=limit)return a.forEach((e=>e.style.display="flex")),void d.classList.add("visually-hidden");d.classList.remove("visually-hidden"),"media"===s?(mediaIndex=(a.length-limit+a.length)%a.length,showDocumentWindow(a,mediaIndex,limit)):(reportIndex=(a.length-limit+a.length)%a.length,showDocumentWindow(a,reportIndex,limit)),d.onclick=()=>{"media"===s?(mediaIndex=(mediaIndex-1+a.length)%a.length,showDocumentWindow(a,mediaIndex,limit)):(reportIndex=(reportIndex-1+a.length)%a.length,showDocumentWindow(a,reportIndex,limit))}}function showDocumentWindow(e,t,s){const a=e.length;e.forEach((e=>{e.style.display="none"}));for(let d=0;d<s;d++){e[(t+d)%a].style.display="flex"}}document.getElementById("order-media").addEventListener("click",(()=>{const e=document.getElementById("toggle-media");if(e.classList.contains("collapsed")){e.classList.remove("collapsed");const t=mediaFiles.querySelectorAll(".dashboard-files__media-document"),s=mediaFiles.querySelectorAll(".dashboard-files__note"),a=document.getElementById("show-more-media");t.forEach((e=>e.classList.remove("visually-hidden"))),s.forEach((e=>e.classList.remove("visually-hidden"))),a.classList.remove("visually-hidden")}simulateAsync("media")})),document.getElementById("order-report").addEventListener("click",(()=>{const e=document.getElementById("toggle-report");if(e.classList.contains("collapsed")){e.classList.remove("collapsed");const t=reportFiles.querySelectorAll(".dashboard-files__media-document"),s=reportFiles.querySelectorAll(".dashboard-files__note"),a=document.getElementById("show-more-report");t.forEach((e=>e.classList.remove("visually-hidden"))),s.forEach((e=>e.classList.remove("visually-hidden"))),a.classList.remove("visually-hidden")}simulateAsync("report")})),document.getElementById("send-message").addEventListener("click",(()=>{const e=document.getElementById("chat-message"),t=e.value.trim();t&&(appendChatMessage("",t,"dashboard-chat__message","dashboard-chat__message-time"),e.value="")})),document.getElementById("chat-message").addEventListener("keydown",(e=>{"Enter"===e.key&&document.getElementById("send-message").click()})),document.getElementById("toggle-media").addEventListener("click",(()=>{const e=mediaFiles.querySelectorAll(".dashboard-files__media-document"),t=document.getElementById("show-more-media"),s=mediaFiles.querySelectorAll(".dashboard-files__note");e.forEach((e=>{e.classList.toggle("visually-hidden")})),t&&!t.classList.contains("visually-hidden")&&t.classList.toggle("visually-hidden"),s.forEach((e=>e.classList.toggle("visually-hidden"))),document.getElementById("toggle-media").classList.toggle("collapsed"),document.getElementById("toggle-media").classList.contains("collapsed")?t.classList.add("visually-hidden"):ShowMore(mediaFiles,"show-more-media","media")})),document.getElementById("toggle-report").addEventListener("click",(()=>{const e=reportFiles.querySelectorAll(".dashboard-files__media-document"),t=document.getElementById("show-more-report"),s=reportFiles.querySelectorAll(".dashboard-files__note");e.forEach((e=>{e.classList.toggle("visually-hidden")})),t&&!t.classList.contains("visually-hidden")&&t.classList.toggle("visually-hidden"),s.forEach((e=>e.classList.toggle("visually-hidden"))),document.getElementById("toggle-report").classList.toggle("collapsed"),document.getElementById("toggle-report").classList.contains("collapsed")?t.classList.add("visually-hidden"):ShowMore(reportFiles,"show-more-report","report")}));const btnMore=document.querySelector(".dashboard-chat__top-more"),windowMore=document.querySelector(".dashboard-chat__top-more__inner");function checkFilesReady(){if(window.matchMedia("(max-width: 375px)").matches){const e=document.getElementById("mobile-media"),t=document.getElementById("mobile-report"),s=mediaFiles.querySelectorAll(".dashboard-files__media-document"),a=reportFiles.querySelectorAll(".dashboard-files__media-document");if(s.length>0){if(e.classList.add("active-media"),!e.querySelector(".mobile-icon")){const t=document.createElement("img");t.src="../images/mobile-ready.svg",t.alt="",t.classList.add("mobile-icon"),t.style.cssText="width: 16px; height: 16px; margin-left: auto;",e.appendChild(t)}}else e.classList.remove("active-media");if(a.length>0){if(t.classList.add("active-report"),!t.querySelector(".mobile-status-icon")){const e=document.createElement("img");e.src="../images/mobile-ready.svg",e.alt="",e.classList.add("mobile-status-icon"),e.style.cssText="width: 16px; height: 16px; margin-left: auto;",t.appendChild(e)}}else t.classList.remove("active-report")}}btnMore.addEventListener("click",(function(){windowMore.classList.toggle("visually-hidden")})),handleScreenSizeChange(mobileQuery),mobileQuery.addEventListener("change",handleScreenSizeChange);